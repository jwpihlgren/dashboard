import{c as w,d as M,e as d,i as O,j as P}from"./chunk-RV3KCXOY.js";import{g as x}from"./chunk-X27PTZCP.js";import{Ab as u,Bb as v,Cb as h,Tb as y,Xa as m,ab as s,gb as o,ka as g,kc as C,tb as p,xa as l,ya as f}from"./chunk-CQTB3V4U.js";var _=(()=>{class n{constructor(e,t,i){this.elementRef=e,this.weatherService=t,this.differs=i,this.width=400,this.height=500,this.margin={top:20,right:30,bottom:30,left:40},this.parentPadding=16,this.yTickHeight=66,this.yTickOffset=this.yTickHeight,this.domainMin=-15,this.domainMax=35,this.domainPadding=5,this.differ=this.differs.find({}).create()}ngOnInit(){this.width=this.elementRef.nativeElement.offsetWidth;let[e,t]=this.forecast.reduce((i,a)=>[Math.min(i[0],a.minTemperature),Math.max(i[1],a.maxTemperature)],[1/0,-1/0]);this.domainMin=e-Math.min((t-e)/1,this.domainPadding),this.domainMax=t+Math.min((t-e)/1,this.domainPadding),this.createChart()}ngDoCheck(){this.differ.diff(this.forecast)&&(this.deleteChart(),this.createChart(),this.drawBars(this.forecast))}ngOnChanges(e){if(this.svg){let t=!1;this.svg.node().getBoundingClientRect().width!==this.width&&(this.width=this.svg.node().getBoundingClientRect().width,t=!0),this.svg.node().getBoundingClientRect().height!==this.height&&(this.height=this.svg.node().getBoundingClientRect().height,t=!0),t&&(this.deleteChart(),this.createChart(),this.drawBars(this.forecast))}}createChart(){this.svg=d("#bar").append("svg").attr("width","100%").attr("height","100%")}drawBars(e){let t=O().domain(e.map(r=>r.validTime.toString())).range([this.margin.left,this.width-this.margin.right]).padding(.7),i=P().domain([this.domainMin,this.domainMax]).range([this.height-this.yTickOffset-this.margin.top,0]).nice(),a=["S\xD6N","M\xC5N","TIS","ONS","TOR","FRE","L\xD6R"];this.svg.append("g").attr("transform","translate(0,"+(this.height-this.yTickHeight)+")").attr("class","no-grid").call(w(t).tickFormat((r,c)=>a[new Date(r).getDay()])).selectAll("text").style("text-anchor","center");let k=M(i).tickSize(this.width-this.margin.left*2).ticks(5);this.svg.append("g").attr("class","grid").attr("transform","translate("+(this.width-this.margin.left*.75)+","+this.margin.top+")").call(k),this.svg.selectAll("bars").data(e).enter().append("rect").attr("x",r=>t(r.validTime.toString())).attr("y",r=>i(r.maxTemperature)).attr("width",t.bandwidth()).attr("height",8).attr("fill","#d04a35").transition().duration(1500).attr("height",r=>this.height-this.yTickOffset-i(r.maxTemperature)-(this.height-this.yTickOffset-i(r.minTemperature))).attr("transform","translate(0,"+this.margin.top+")"),this.svg.selectAll(".tick")._groups[0].forEach((r,c)=>{e[c]&&d(r).append("svg").attr("class","icon daily-icon").attr("x",-12).attr("y",24).attr("width",24).attr("height",24).append("use").attr("xlink:href",this.weatherService.getIconUrl(e[c].symbol))})}deleteChart(){this.svg?.remove()}static{this.\u0275fac=function(t){return new(t||n)(s(f),s(x),s(C))}}static{this.\u0275cmp=o({type:n,selectors:[["app-bar-range-chart"]],inputs:{forecast:"forecast"},features:[g],decls:1,vars:0,consts:[["id","bar"]],template:function(t,i){t&1&&h(0,"figure",0)},styles:["[_nghost-%COMP%]{display:flex}figure[_ngcontent-%COMP%]{flex-grow:1}[_nghost-%COMP%]     .icon{fill:var( --pnc-sys-color-on-surface);max-width:40px;max-height:40px}[_nghost-%COMP%]     .icon use g{width:40px;height:40px}[_nghost-%COMP%]     g.no-grid g.tick line, [_nghost-%COMP%]     path.domain{color:transparent}[_nghost-%COMP%]     g.grid g.tick line{color:var( --pnc-sys-color-on-surface);stroke-dasharray:3,3}[_nghost-%COMP%]     text{font-size:var(--fs-100);text-transform:uppercase;font-weight:600;color:var( --pnc-sys-color-on-surface);letter-spacing:.067rem}[_nghost-%COMP%]     rect{ry:.5rem;fill:var( --pnc-sys-color-primary)}"]})}}return n})();var F=(()=>{class n{constructor(){this.forecastDataSeries=[],this.forecast=l.required()}createForecastDataSeries(e){return[...e]}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275cmp=o({type:n,selectors:[["app-weather-card"]],inputs:{forecast:[1,"forecast"]},decls:3,vars:1,consts:[[1,"flex","row","j-start","a-center","gap-sm"],[3,"forecast"]],template:function(t,i){t&1&&(u(0,"h6",0),y(1,"Sjudagars prognos"),v(),h(2,"app-bar-range-chart",1)),t&2&&(m(2),p("forecast",i.createForecastDataSeries(i.forecast().daily)))},dependencies:[_],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;gap:var(--medium);padding:var(--medium);min-height:350px;height:100%}span[_ngcontent-%COMP%]{color:var( --pnc-sys-color-primary)}app-bar-range-chart[_ngcontent-%COMP%]{flex-grow:1;background-color:var( --pnc-sys-color-surface-container-high);border-radius:var(--small)}.weather-side-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:var(--large);padding:var(--medium)}.weather-side-info-details[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:var(--medium)}.detail[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;align-items:center;gap:var(--small)}.weather-side-info-currently[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:10rem;height:10rem;justify-content:center;align-items:center;border-radius:var(--pill)}.fetch-date[_ngcontent-%COMP%]{font-size:var(--fs-400);font-weight:var(--fw-300)}@media (min-width: 768px){.weather-side-info-details[_ngcontent-%COMP%]{display:flex;flex-direction:column}.detail[_ngcontent-%COMP%]{flex-direction:row}.wrapper[_ngcontent-%COMP%]{flex-direction:row-reverse}}"]})}}return n})();export{F as a};
