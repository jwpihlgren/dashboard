import{a as l,b as f,c as m,d as C,f as u,g as v,h as n,j as D,k as y,l as w,m as x,n as h}from"./chunk-RV3KCXOY.js";import{ab as o,gb as p,jb as d,kc as g,ya as c}from"./chunk-CQTB3V4U.js";var O=(()=>{class s{constructor(e,t){this.elementRef=e,this.differs=t,this.margin={top:20,right:0,bottom:30,left:35},this.pathGradient="gradient-id-1",this.areaGradient="gradient-id-2",this.chart="chart",this.chartConfig={chartColors:["#f8c03f","#32d2ac","#5693e9"],thresholds:[.3,.6],domain:[0,100],unit:"",data:[{date:new Date(new Date().setDate(new Date().getDate()+0)),value:20},{date:new Date(new Date().setDate(new Date().getDate()+1)),value:60},{date:new Date(new Date().setDate(new Date().getDate()+2)),value:90},{date:new Date(new Date().setDate(new Date().getDate()+3)),value:20},{date:new Date(new Date().setDate(new Date().getDate()+4)),value:60},{date:new Date(new Date().setDate(new Date().getDate()+5)),value:90},{date:new Date(new Date().setDate(new Date().getDate()+6)),value:100}]},this.differ=this.differs.find({}).create()}ngOnInit(){this.width=this.elementRef.nativeElement.offsetWidth,this.height=this.elementRef.nativeElement.offsetHeight,this.renderChart()}renderChart(){this.y=this.createY(),this.x=this.createX(),this.appendChartToDOM(),this.appendXAxis(),this.appendYAxis(),this.appendLinearGradientToPath(),this.appendLinearGradientToArea(),this.appendArea(),this.appendPath(),this.elementRef.nativeElement.appendChild(this.svg.node())}appendChartToDOM(){let e=u("svg");e.attr("width","100%").attr("height","100%"),this.svg=e,this.defs=this.svg.append("defs")}removeChart(){v("svg > *").remove()}createX(){return y().domain(l(this.chartConfig.data,e=>e.date)).range(this.chartConfig.margins?[this.chartConfig.margins.left,this.width-this.chartConfig.margins.right]:[this.margin.left,this.width-this.margin.right])}appendXAxis(){let e=t=>{t.attr("transform",`translate(0, -${this.chartConfig.margins?this.chartConfig.margins.top:this.margin.top})`).call(m(this.x).ticks(this.width/(this.width*.15)).tickSizeOuter(0).tickSize(this.height)).call(a=>a.select(".domain").remove())};this.svg.append("g").call(e)}createY(){return D().domain(this.chartConfig.domain).nice().range(this.chartConfig.margins?[this.height-this.chartConfig.margins.bottom,this.chartConfig.margins.top]:[this.height-this.margin.bottom,this.margin.top])}appendYAxis(){let e=t=>{t.attr("transform",`translate(${this.width},0)`).call(C(this.y).ticks(this.height/(this.height*.15)).tickSize(this.width-(this.chartConfig.margins?.left||this.margin.left)+(this.chartConfig.margins?.right||this.margin.right))).call(a=>a.select(".domain").remove()).call(a=>a.select(".tick:last-of-type text").append("tspan").text(this.chartConfig.unit))};this.svg.append("g").call(e)}appendLinearGradientToPath(){let e=n();this.svg.append("linearGradient").attr("id",this.pathGradient).attr("gradientUnits","userSpaceOnUse").attr("x1",0).attr("y1",this.height-(this.chartConfig.margins?this.chartConfig.margins?.bottom:this.margin.bottom)).attr("x2",0).attr("y2",this.chartConfig.margins?this.chartConfig.margins.top:this.margin.top).selectAll("stop").exit().remove().data(f(0,1,10)).join("stop").attr("offset",t=>t).attr("stop-color",t=>this.colorFinder(t,[...this.chartConfig.thresholds,1]))}appendLinearGradientToArea(){let e=n(),t=this.defs.append("linearGradient").attr("id",this.areaGradient).attr("gradientUnits","userSpaceOnUse").attr("x1",0).attr("y1",this.height-(this.chartConfig.margins?this.chartConfig.margins.bottom:this.margin.bottom)).attr("x2",0).attr("y2",this.chartConfig.margins?this.chartConfig.margins.top:this.margin.top);t.append("stop").attr("offset","0%").attr("stop-color",this.chartConfig.chartColors[0]).attr("stop-opacity",0).attr("offset",this.chartConfig.thresholds[0]*10+"%").attr("stop-color",this.chartConfig.chartColors[0]).attr("stop-opacity",0),t.append("stop").attr("offset",this.chartConfig.thresholds[0]*80+"%").attr("stop-color",this.chartConfig.chartColors[0]).attr("stop-opacity",.3),t.append("stop").attr("offset",this.chartConfig.thresholds[0]*100+"%").attr("stop-color",this.chartConfig.chartColors[0]).attr("stop-opacity",.2),t.append("stop").attr("offset",this.chartConfig.thresholds[0]*100+"%").attr("stop-color",this.chartConfig.chartColors[1]).attr("stop-opacity",.05),t.append("stop").attr("offset",this.chartConfig.thresholds[1]*80+"%").attr("stop-color",this.chartConfig.chartColors[1]).attr("stop-opacity",.3),t.append("stop").attr("offset",this.chartConfig.thresholds[1]*100+"%").attr("stop-color",this.chartConfig.chartColors[1]).attr("stop-opacity",.4),t.append("stop").attr("offset",this.chartConfig.thresholds[1]*100+"%").attr("stop-color",this.chartConfig.chartColors[2]).attr("stop-opacity",.4),t.append("stop").attr("offset","95%").attr("stop-color",this.chartConfig.chartColors[2]).attr("stop-opacity",.8)}colorFinder(e,t=[.3,.6,1]){for(let a=0;a<t.length;a++)if(e<=t[a])return this.chartConfig.chartColors[a];return this.chartConfig.chartColors[0]}opacityFinder(e,t=[.6,.9]){return console.log(e),e<t[0]?t[0]+"":e>t[1]?t[1]+"":e+""}appendPath(){let e=w().curve(h).defined(t=>!isNaN(t.value)).x(t=>this.x(t.date)).y(t=>this.y(t.value));this.svg.append("path").datum(this.chartConfig.data).attr("fill","none").attr("stroke","url(#"+this.pathGradient+")").attr("stroke-width",3).attr("stroke-linejoin","round").attr("stroke-linecap","round").attr("d",e)}appendArea(){let e=x().curve(h).defined(t=>!isNaN(t.value)).x(t=>this.x(t.date)).y0(this.height-(this.chartConfig.margins?this.chartConfig.margins.bottom:this.margin.bottom)).y1(t=>this.y(t.value));this.svg.append("path").datum(this.chartConfig.data).attr("fill","url(#"+this.areaGradient+")").attr("d",e)}static{this.\u0275fac=function(t){return new(t||s)(o(c),o(g))}}static{this.\u0275cmp=p({type:s,selectors:[["app-area-chart"]],inputs:{chartConfig:"chartConfig"},decls:0,vars:0,template:function(t,a){},styles:["[_nghost-%COMP%]{height:1000px}[_nghost-%COMP%]     g.no-grid g.tick line, [_nghost-%COMP%]     path.domain{color:transparent}[_nghost-%COMP%]     .y-axis .tick line{stroke:var(--pnc-sys-color-on-surface)}[_nghost-%COMP%]     text{font-size:var(--fs-100);text-transform:uppercase;font-weight:600;color:var(--pnc-sys-color-on-surface);letter-spacing:.067rem}[_nghost-%COMP%]     rect{ry:.5rem;fill:var( --pnc-sys-color-primary)}[_nghost-%COMP%]     g.tick line{stroke:var(--pnc-sys-color-on-surface);stroke-opacity:.5;stroke-dasharray:3,3;shape-rendering:crispEdges}"]})}}return s})();var P=(()=>{class s{transform(e,t,a){return a==="value"&&t==="min"?e.reduce((i,r)=>i.value<=r.value?i:r):a==="value"&&t==="max"?e.reduce((i,r)=>i.value>=r.value?i:r):a==="date"&&t==="min"?e.reduce((i,r)=>i.date<=r.date?i:r):e.reduce((i,r)=>i.date>=r.date?i:r)}static{this.\u0275fac=function(t){return new(t||s)}}static{this.\u0275pipe=d({name:"hydrologicalMinMax",type:s,pure:!0})}}return s})();export{O as a,P as b};
